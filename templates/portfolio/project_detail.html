{% extends "base.html" %}
{% load static %}
{% block title %}{{ project.title }}{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/project_details.css' %}">
{% endblock %}

{% block content %}

<!-- PROJECT HERO -->
<header class="hero-title">
    {% if project.services.exists %}
        <div class="section-title" style="justify-content: center;">
            {{ project.services.all|join:", " }}
        </div>
    {% endif %}

    <h1 class="display-text">
        {{ project.title }}
    </h1>

    {% if project.excerpt %}
    <p class="hero-excerpt">
        {{ project.excerpt }}
    </p>
    {% endif %}

    <div class="project-metadata">
        {% if project.client_name %}
        <div class="meta-item">
            <strong>Client</strong>
            <span>{{ project.client_name }}</span>
        </div>
        {% endif %}

        {% if project.timeline %}
        <div class="meta-item">
            <strong>Timeline</strong>
            <span>{{ project.timeline }}</span>
        </div>
        {% endif %}

        {% if project.services.exists %}
        <div class="meta-item">
            <strong>Services</strong>
            <span>
                {% for service in project.services.all %}
                    {{ service.title }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </span>
        </div>
        {% endif %}

        <div class="meta-item">
            <strong>Year</strong>
            <span>{{ project.created|date:"Y" }}</span>
        </div>
    </div>
</header>

<!-- MAIN IMAGE -->
{% if project.image %}
<div class="main-image-container">
    <img src="{{ project.image.url }}" alt="{{ project.title }}">
</div>
{% endif %}

<!-- CASE STUDY SECTIONS -->
<section class="case-study-content">

    {% for section in project.sections.all %}
        {% if section.is_highlight %}
            <!-- HIGHLIGHT / TESTIMONIAL -->
            <div class="testimonial-block">
                {{ section.body|linebreaks }}
            </div>
        {% else %}
            <div class="content-block">
                <div class="section-title">
                    {{ forloop.counter|stringformat:"02d" }}.
                </div>

                <h2>{{ section.heading }}</h2>

                {% if section.subheading %}
                    <p class="section-subheading">
                        {{ section.subheading }}
                    </p>
                {% endif %}

                {{ section.body|linebreaks }}
            </div>
        {% endif %}
    {% empty %}
        <p>No case study content available.</p>
    {% endfor %}

</section>

<!-- PROJECT LINKS -->
{% if project.url or project.repo_url %}
<section class="project-links">
    {% if project.url %}
        <a href="{{ project.url }}" class="btn-link" target="_blank">
            View Live Project ↗
        </a>
    {% endif %}

    {% if project.repo_url %}
        <a href="{{ project.repo_url }}" class="btn-link" target="_blank">
            View Source Code ↗
        </a>
    {% endif %}
</section>
{% endif %}

<!-- NEXT PROJECT -->
{% if next_project %}
<div class="next-project-link">
    <a href="{% url 'project_detail' next_project.slug %}" class="btn-link">
        View Next Project: {{ next_project.title }} →
    </a>
</div>
{% endif %}

{% endblock %}
